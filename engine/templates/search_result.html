{% extends "home.html" %}
{% load crispy_forms_tags %}
{% load static %}
{% load extended_tags %}

{% block set_list %}

<link rel="stylesheet" type="text/css" href="{% static 'custom_css/search_result.css' %}">

<script src="{% static 'custom_js/search_condition_tab.js' %}"></script>
<script>
  $( function() {
    $( "#accordion" ).accordion({
      collapsible: true,
      active: false,
    });
  } );
  </script>

{% if error != '' %}

    <h1>Error</h1>
{% else %}

    <div class="container-fluid" style="min-height:95%;">
        <div class="row">
            <nav class="col-md-2 d-none d-sm-block bg-dark sidebar" style="">
                <div class="sidebar-sticky" id="accordion">
                    <span class="active"> Advanced Search <i class="material-icons"></i></span>
                    <div>
                    <form>
                        <div class="input-group input-group-sm mb-3">

                         <fieldset>
                              <div class="form-row">
                                  {{form.name_query}}
                                  <div class="input-group input-group-sm mb-3">

                                      <div class="input-group-prepend">
                                        <span class="input-group-text">Name</span>
                                      </div>
                                      {{form.name}}
                                  </div>

                                  <div class="form-row">

                                      <div class="input-group input-group-sm mb-3">

                                          <div class="input-group-prepend">
                                            <span class="input-group-text">Set</span>
                                          </div>
                                          {{form.name}}
                                      </div>

                                  </div>
                              </div>
                                  <div class="form-row">
                                      <div class="form-row">
                                      {{form.color_query}}
                                      <div class="input-group input-group-sm mb-3">
                                      <div class="input-group-prepend">
                                        <span class="input-group-text">Colors</span>
                                      </div>
                                      {{form.name}}
                                  </div>

                                  </div>
                          </div>

                         </fieldset>

                        </div>

                    </form>
                    </div>

                </div>
            </nav>
            <div style="" class="col-sm-10">
                <table style="color: rgb(80,80,80);" class="nav-tabs nav-stacked table table table-hover table-lg">
                    <thead class="thead-inverse">
                    </thead>
                    <tbody>
                        {% for item in items %}
                            <tr>
                                <td>
                                    <img style="max-height:200px;" src="{{item.image_url}}">
                                    <div id="imgbox"></div>
                                </td>

                                <td>
                                    <a href="{% url 'product_detail' item.product_id %}">{{item.name}}</a>
                                </td>

                                <td>{{item.mana_cost}}</td>

                                <td>{{item.card_type}}</td>

                                <td>{{item.expansion}}</td>

                                <td>
                                    <div style="position: relative;">

                                        <ul class="nav nav-tabs mb-3 condition-info" id="{{item.product_id}}" role="tablist"></ul>

                                        <script>
                                             conditionTab(
                                                "clean", "CL", "{{item.normal_clean_stock}}", "{{item.foil_clean_stock}}", "{{item.product_id}}",
                                                "true"
                                             );

                                              conditionTab(
                                                "played", "PL", "{{item.normal_played_stock}}", "{{item.foil_played_stock}}", "{{item.product_id}}",
                                                "false"
                                             );

                                             conditionTab(
                                                "heavily_played", "HP", "{{item.normal_heavily_played_stock}}",
                                                 "{{item.foil_heavily__played_stock}}", "{{item.product_id}}", "false"
                                             );
                                        </script>


                                        <div class="tab-content" id="tabs-tabContent-{{item.product_id}}">



                                        </div>

                                        <script>
                                            populateConditionTable(
                                                "true", "clean", "{{item.product_id}}", "{{item.normal_clean_stock}}",
                                                 "{{item.foil_clean_stock}}", "{{item.normal_clean_price}}", "{{item.foil_clean_price}}"
                                            );

                                            populateConditionTable(
                                                "false", "played", "{{item.product_id}}", "{{item.normal_played_stock}}",
                                                 "{{item.foil_played_stock}}", "{{item.normal_played_price}}", "{{item.foil_played_price}}"
                                            );

                                            populateConditionTable(
                                                "false", "heavily_played", "{{item.product_id}}", "{{item.normal_heavily_played_stock}}",
                                                 "{{item.foil_heavily_played_stock}}", "{{item.normal_heavily_played_price}}",
                                                 "{{item.foil_heavily_played_price}}"
                                            );

                                        </script>
                                    </div>
                                </td>
                            </tr>
                        {% endfor %}
                    </tbody>

                </table>
            </div>

        </div>

    </div>



{% endif %}

<script src="{% static 'custom_js/select_tab_search_results.js' %}"></script>

{% endblock %}
<!--  -->