{% extends "home.html" %}
{% load crispy_forms_tags %}
{% load extended_tags %}
{% block set_list %}
{% include 'search_result_style.html' %}

		{% if error != '' %}
		<center>
			<div id="errorFrameOutsideFrame">
				<div id="errorFrame">
			      	<H3>"<span style="color: red;">{{error}}</span>" not found in our Database</H3>
			      	<h4>Please check your spelling</h4>
		        </div>
	        </div>
        </center>
      	{% else %}
      	<iframe name="submit-frame" style="display: none"></iframe>


      	{% for product, card_price, form in products %}
		<div style="margin-bottom: 3%;" class="col-sm-2">
        <div class=col-sm-12>
          <form action="{% url 'add_to_cart' product.id %}" method="post" target="submit-frame">{% csrf_token %}
            <div style="" class="row" id=""> 
              <legend class="border-bottom mb-4">{{product.name}}</legend>
              <img class="img-responsive center-block" src="https://6d4be195623157e28848-7697ece4918e0a73861de0eb37d08968.ssl.cf1.rackcdn.com/33252_200w.jpg">
            </div>

            <div style="" class="row" id=""> 
            <center>
            {{form|crispy}}


              <div class="col-sm-12">             
                <b><span class="price_id" id="price_{{product.product_id}}">${{product.price}} ({{product.quantity}} in stock)</span></b>
              </div>

              <input id='card_price' type="hidden" name="card_price" min={{card_price}} max={{card_price}} value={{card_price}}>
              

              <div class="col-sm-12">
                
              <input style="color: black;" size="2" id='qtyBox' type="number" name="quantity" min="1" max="8">
            
              <button style="margin-top: -2%;" class="btn btn-success" data-toggle="popover" data-animation="true"  data-content="Added to cart"  type="submit" id='button'>+</button>
            
              </div>

              <div class="col-sm-2">
              
              </div>

              
              
            </center>
          </div>
          </form>
        </div>
                  
    </div>


 
     	{% endfor %}
     	{% endif %}

 <script>
  var init_condition = 'near mint';
  var init_language = 'english';
  var init_foil = false;
  var dict = {{model|safe}};
  

  function conditionChange(obj){
    var condition = obj.value;
    init_condition = condition;
    var idee = obj.id;
    var item_condition = dict[idee][init_foil][init_language][condition]['condition'];
    var item_quantity = dict[idee][init_foil][init_language][condition]['quantity'];
    var item_price = dict[idee][init_foil][init_language][condition]['price'];

    document.getElementById('price_' + obj.id).innerText = '$' + item_price + " " + "(" + (item_quantity) + " in stock)";
  }


  function languageChange(obj){
    var language = obj.value;
    init_language = language;
    var idee = obj.id;
    var item_condition = dict[idee][init_foil][language][init_condition]['condition'];
    var item_price = dict[idee][init_foil][language][init_condition]['price'];
    var item_quantity = dict[idee][init_foil][language][init_condition]['quantity'];

    document.getElementById('price_' + obj.id).innerText = '$' + item_price + " " + "(" + (item_quantity) + " in stock)";

  }


  function foilChange(obj){
    var foil = obj.value;
    init_foil = foil;
    var idee = obj.id;
    var item_condition = dict[idee][foil][init_language][init_condition]['condition'];
    var item_price = dict[idee][foil][init_language][init_condition]['price'];
    var item_quantity = dict[idee][foil][init_language][init_condition]['quantity'];
    document.getElementById('price_' + obj.id).innerText = '$' + item_price + " " + "(" + (item_quantity) + " in stock)";

  }




</script>      


{% endblock %}



  



